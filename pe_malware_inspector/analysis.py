import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import os

mycwd = os.getcwd()
folder_path=os.path.dirname(mycwd)

# Load the dataset
dataframe = pd.read_csv(folder_path+r"\\data\\features.csv", usecols=["label", "size_image", "size_code", "size_uninit", "pe_majorlink", "pe_minorlink", "pe_driver", "pe_exe", "pe_dll", "pe_char", "debug_size", "major_version", "minor_version", "iat_rva", "export_size", "check_sum", "generated_check_sum", "virtual_address", "virtual_size", "number_of_sections", "number_of_rva_and_sizes", "total_size_pe" ])

# Display basic statistics and information about the dataset
print("Dataset Information:")
print(dataframe.info(verbose=False,memory_usage='deep'))

 
# Displaying count of rows of the data 
print('Total count of rows in the dataset: ',dataframe.shape[0])
print('-'*42)
# Displaying count of columns of the data 
print('Total count of rows in the dataset: ',dataframe.shape[1])
print('-'*42)

# Displaying all the names of the data features
print('The names of the data columns :',list(dataframe.columns.values))
print('-'*42)

# Displaying count of the nan and unique values  of the data features
print('The total unique values: ',dataframe.nunique())


# Summary statistics for numerical features
print("\nSummary Statistics:")
print(dataframe.describe())


# Class distribution
plt.figure(figsize=(8, 6))
sns.countplot(x='label', data=dataframe)
plt.title('Class Distribution')
plt.xlabel('Class')
plt.ylabel('Count')
plt.show()

 
# Pairwise feature correlations
correlation_matrix = dataframe.corr()
plt.figure(figsize=(20, 15))
sns.heatmap(correlation_matrix, annot=True, cmap='coolwarm', linewidths=0.5)
plt.title('Feature Correlation Matrix')
plt.show()


# Box plots to visualize feature distributions by class
plt.figure(figsize=(12, 6))
sns.boxplot(x='label', y='size_image', data=dataframe)
plt.title('Size Image by Class')
plt.xlabel('Class')
plt.ylabel('Size Image')
plt.show()


plt.figure(figsize=(12, 6))
sns.boxplot(x='label', y='size_code', data=dataframe)
plt.title('Size Code by Class')
plt.xlabel('Class')
plt.ylabel('Size Code')
plt.show()


# Distribution of selected features
plt.figure(figsize=(12, 6))
sns.histplot(dataframe['size_image'], bins=30, kde=True)
plt.title('Distribution of Size Image')
plt.xlabel('Size Image')
plt.ylabel('Count')
plt.show()


plt.figure(figsize=(12, 6))
sns.histplot(dataframe['size_code'], bins=30, kde=True)
plt.title('Distribution of Size Code')
plt.xlabel('Size Code')
plt.ylabel('Count')
plt.show()


 




